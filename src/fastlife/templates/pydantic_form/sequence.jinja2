{% from "globals.jinja2" import button %}
<details open>
  <summary>
    <h4 class="inline mb-2 text-base font-bold text-neutral-900 dark:text-white">{{widget.title}}</h4>
  </summary>
  <div>
    <script>
      function getName() {
        const el = document.getElementById("{{widget.id}}");
        const len = el.dataset.length;
        el.dataset.length = parseInt(len) + 1;
        return "{{type.name}}." + len
      }
    </script>

    <div id="{{widget.id}}" data-length="{{children_widgets|length|string}}">
      {% for child in children_widgets %}
      {{ child }}
      {% endfor%}
    </div>

    {{
    button(
    "Add",
    type="button",
    target="previous",
    swap="beforeend",
    id=widget.id + "-add",
    vals='js:{"name": getName(), "token": "' + type.token + '"}',
    get=type.url,
    )
    }}
  </div>
</details>
